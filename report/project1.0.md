تمرین گروهی ۱/۰ - آشنایی با pintos
======================

شماره گروه:
-----
> نام و آدرس پست الکترونیکی اعضای گروه را در این قسمت بنویسید.

آرمان بابایی <292arma@gmail.com>

نام و نام خانوادگی <example@example.com> 

نام و نام خانوادگی <example@example.com> 

نام و نام خانوادگی <example@example.com> 

مقدمات
----------
> اگر نکات اضافه‌ای در مورد تمرین یا برای دستیاران آموزشی دارید در این قسمت بنویسید.


> لطفا در این قسمت تمامی منابعی (غیر از مستندات Pintos، اسلاید‌ها و دیگر منابع  درس) را که برای تمرین از آن‌ها استفاده کرده‌اید در این قسمت بنویسید.

آشنایی با pintos
============
>  در مستند تمرین گروهی ۱۹ سوال مطرح شده است. پاسخ آن ها را در زیر بنویسید.


## یافتن دستور معیوب

۱.
0xc0000008

۲.
eip=0x8048757

۳.
تابع `_start`
```
08048754 <_start>:
   8048754:       83 ec 1c                sub    $0x1c,%esp
-> 8048757:       8b 44 24 24             mov    0x24(%esp),%eax
   804875b:       89 44 24 04             mov    %eax,0x4(%esp)
   804875f:       8b 44 24 20             mov    0x20(%esp),%eax
   8048763:       89 04 24                mov    %eax,(%esp)
   8048766:       e8 35 f9 ff ff          call   80480a0 <main>
   804876b:       89 04 24                mov    %eax,(%esp)
   804876e:       e8 49 1b 00 00          call   804a2bc <exit>

```

۴.
```
void
_start (int argc, char *argv[])
{
exit (main (argc, argv));
}
```
در ابتدا با کم کردن esp به اندازه‌ی 0x1c فضای کافی برای قرار گرفتن ورودی‌ها و آدرس برگشت و همچنین فضای خالی برای انطباق با cache قرار داده می‌شود. (با اضافه شدن چهار بابت آدرس برگشت، مقدار کم شدن برابر 0x20 می‌شود.)
در ادامه با توجه به این که انتقال از حافظه به حافظه ممکن نیست، به کمک واسطه‌ی eax مقدار 0x8 در ابتدای صدازدن تابع یعنی همان argv به 0x4 کنونی یعنی محل قرار دادن این آرگومان برای صدا زدن تابع main قرار می‌گیرد.
در ادامه همین کار برای 0x4 قبلی که همان argc است انجام می‌شود و در محل esp قرار می‌گیرد.
سپس به کمک دستور call تابع main صدا زده می‌شود و خروجی در eax قرار می‌گیرد.
در نهایت خروجی main در esp به عنوان آرگومان تابع exit قرار می‌گیرد و این تابع با دستور call صدا زده می‌شود.

۵.
با توجه به مستندات pintos، محل شروع stack آدرس 0xc0000000 است و آدرس‌های کوچک‌تر از آن در استک هستند. این در حالی‌ست که اگر به esp در لحظه‌ی اجرای دستور نگاه کنیم به مقدار 
`esp=bfffffe4`
می‌رسیم که متوجه می‌شویم در هنگام صدا زده شدن تابع، esp در0xc0000000 بوده. یعنی بر خلاف آن‌چه به تابع وعده داده شده بود، ورودی‌ها در استک قرار نگرفته‌اند و نشانگر استک حرکت نکرده است.

## به سوی crash

۶.
ریسه‌ی main با آدرس0xc000e000 این دستور را اجرا می‌کند. ریسه‌ی دیگری که در وجود دارد idle است که اطلاعات هردوی آن‌ها در زیر آمده است.
```
pintos-debug: dumplist #0: 0xc000e000 {tid = 1, status = THREAD_RUNNING, name = "main", '\000' <repeats 11 times>, stack = 0xc000edec <incomplete sequence \357>, priority = 31, allelem = {prev = 0xc0035910 <all_list>, next = 0xc0104
020}, elem = {prev = 0xc0035920 <ready_list>, next = 0xc0035928 <ready_list+8>}, pagedir = 0x0, magic = 3446325067}
pintos-debug: dumplist #1: 0xc0104000 {tid = 2, status = THREAD_BLOCKED, name = "idle", '\000' <repeats 11 times>, stack = 0xc0104f34 "", priority = 0, allelem = {prev = 0xc000e020, next = 0xc0035918 <all_list+8>}, elem = {prev = 0x
c0035920 <ready_list>, next = 0xc0035928 <ready_list+8>}, pagedir = 0x0, magic = 3446325067}
```
۷.

۸.

۹.

۱۰.

۱۱.

۱۲.

۱۳.


## دیباگ

۱۴.

۱۵.

۱۶.

۱۷.

۱۸.

۱۹.